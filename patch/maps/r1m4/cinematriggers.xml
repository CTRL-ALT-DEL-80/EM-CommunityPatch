<?xml version="1.0" encoding="windows-1251" standalone="yes" ?>
<triggers>

<!-- 					Болото закрыто.			 -->

	<trigger Name="RolikBegin_BolotoOF" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
		    SaveAllToleranceStatus(RS_NEUTRAL)
			GetPlayerVehicle():SetCustomLinearVelocity( 0 )
			PlayCustomMusic("Bio01")
			TActivate("RolikEnd_BolotoOF")
			TActivate("trBolotoOF_cam01")
			TActivate("BolotoOF_PathOut")
			Fly("BolotoOF_cam01", CINEMATIC_NO_AIM, 0, 15, 1, 1 )
			StartCinematic()
			AddCinematicMessage( 1, 0.25 )
			trigger:Deactivate()
		</script>
	</trigger>


	<trigger Name="trBolotoOF_cam01" active="0">
 		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<!--event timeout="0" eventid="GE_TIME_PERIOD" /-->
		<script>
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetGamePositionOnGround( CVector(1475.011, 217.387, 1581.962))
				vehPlayer:SetRotation(Quaternion(0.033, 0.685, -0.047, -0.726))
				vehPlayer:SetExternalPathByName("player_path01")
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="BolotoOF_PathOut" active="0">
		<event timeout="5" eventid="GE_TIME_PERIOD" />
		<script>
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetExternalPathByName("player_path02")
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_BolotoOF" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
-- 		println("Boloto END")
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetExternalPathByName("player_path02")
				vehPlayer:PlaceToEndOfPath("player_path02")
			end


			StopPlayingCustomMusic()
			TDeactivate("RolikBegin_BolotoOF")
			TDeactivate("trBolotoOF_cam01")
			TDeactivate("BolotoOF_PathOut")
			TActivate("trMorassTeleportBefore")
			SetCameraBehindPlayerVehicle()
		    RestoreAllToleranceStatus()
			trigger:Deactivate()
		</script>
	</trigger>

<!-- 					Болото открыто.			 -->

	<trigger Name="RolikBegin_Boloto" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
	    SaveAllToleranceStatus(RS_NEUTRAL)
		GetPlayerVehicle():SetCustomLinearVelocity( 0 )

		PlayCustomMusic("Bio05")
		TActivate("RolikEnd_Boloto")
		TActivate("trBoloto_cam01")
		TActivate("trBoloto_cam02")
		TActivate("trBoloto_cam03")
		CreateNewDummyObject( "cargo", "CamTochka", -1, -1, CVector(1279.438, 208.338, 1544.678), Quaternion(0, 0, 0, 0), 0)
		local CToch = GetEntityByName("CamTochka")
		local CTochID = CToch:GetId()
		local vehPID = GetPlayerVehicleId()
--		local st = trigger:GetVar("Count")
		RuleConsole("cinematic_spring_coeff 5.7")
		FlyLinked( "Boloto_cam01", vehPID , 5, 1, 0, nil, nil, nil, nil, nil )
		FlyLinked("Boloto_cam02", CTochID, 5, 0, 0, vehPID, nil, nil, nil, nil )
		Fly("Boloto_cam03", CINEMATIC_NO_AIM, 0, 5, 0, 0 )
		Fly("Boloto_cam03Port", CINEMATIC_NO_AIM, 0, 5, 0, 1 )
		StartCinematic()
		trigger:Deactivate()
		</script>
	</trigger>


	<trigger Name="trBoloto_cam01" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
--		println("1")
			vehPlayer:SetGamePositionOnGround( CVector(1475.011, 217.387, 1581.962))
			vehPlayer:SetRotation(Quaternion(0.015, 0.560, -0.021, -0.828))
			vehPlayer:SetExternalPathByName("player_path03")
		end
		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trBoloto_cam02" active="0">
		<event flypath="Boloto_cam02" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			local stat = GetVar("Boloto").AsInt
            if stat==0 then
				AddCinematicMessage( 2, 0.1 )
			end
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trBoloto_cam03" active="0">
		<event flypath="Boloto_cam03" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
			vehPlayer:SetGamePositionOnGround( CVector(1029.222, 209.832, 1715.359))
			vehPlayer:SetRotation(Quaternion(-0.049, -0.832, -0.060, 0.549))
			vehPlayer:SetThrottle(1)
			vehPlayer:SetCustomLinearVelocity(15)
			vehPlayer:SetExternalPathByName("BolotoViezdPort")
		end

		local stat = GetVar("Boloto").AsInt
		if stat==0 then
			AddCinematicMessage( 3, 0.1 )
		end
		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_Boloto" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
	    SetVar("Boloto",1)
		local CToch = GetEntityByName("CamTochka")
		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
				vehPlayer:SetExternalPathByName("BolotoViezdPort")
				vehPlayer:PlaceToEndOfPath("BolotoViezdPort")
			end
		if CToch then
			CToch:Remove()
		end

		RuleConsole("cinematic_spring_coeff 0.7")
		StopPlayingCustomMusic()

		TDeactivate("RolikBegin_Boloto")
		TDeactivate("trBoloto_cam01")
		TDeactivate("trBoloto_cam03")
		TActivate("trMorassTeleportBefore")
		TActivate("trMorassTeleportAfter")
		SetCameraBehindPlayerVehicle()
	    RestoreAllToleranceStatus()
		trigger:Deactivate()
		</script>
	</trigger>


<!--		переезд болота от самолета в деревню.		 -->


	<trigger Name="RolikBegin_PlaneOut" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
		GetPlayerVehicle():SetCustomLinearVelocity( 0 )
		TActivate("RolikEnd_PlaneOut")
		TActivate("trPlaneOut_cam01")
		TActivate("trPlaneOut_cam02")

		Fly("PlaneOut_cam01", CINEMATIC_NO_AIM, 0, 5, 1, 0 )
		Fly("PlaneOut_cam02", CINEMATIC_NO_AIM, 0, 5, 0, 1 )
		StartCinematic()

		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trPlaneOut_cam01" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>

		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
			vehPlayer:SetGamePositionOnGround( CVector(1118.154, 224.715, 1366.481))
			vehPlayer:SetRotation(Quaternion(0.005, 0.024, -0.006, 1.000))
			vehPlayer:SetExternalPathByName("player_path05")
		end

		trigger:Deactivate()
		</script>
	</trigger>


	<trigger Name="trPlaneOut_cam02" active="0">
		<event flypath="PlaneOut_cam02" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>

		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
			vehPlayer:SetGamePositionOnGround( CVector(1387.950, 211.036, 1593.858))
			vehPlayer:SetRotation(Quaternion(-0.065, 0.731, 0.003, 0.679))
			vehPlayer:SetExternalPathByName("player_path02")
			vehPlayer:SetThrottle(1)
			vehPlayer:SetCustomLinearVelocity(15)
		end

		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_PlaneOut" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>

		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
			vehPlayer:SetExternalPathByName("player_path02")
			vehPlayer:PlaceToEndOfPath("player_path02")
		end


		TDeactivate("RolikBegin_PlaneOut")
		TDeactivate("trPlaneOut_cam01")
		TDeactivate("trPlaneOut_cam02")
		TActivate("trMorassTeleportBefore")
		TActivate("trMorassTeleportAfter")
		SetCameraBehindPlayerVehicle()
		trigger:Deactivate()
		</script>
	</trigger>


<!--		переезд болота от порта в деревню.		-->


	<trigger Name="RolikBegin_PortOut" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
		GetPlayerVehicle():SetCustomLinearVelocity( 0 )
		TActivate("RolikEnd_PortOut")
		TActivate("trPortOut_cam01")
		TActivate("trPortOut_cam02")

		SaveAllToleranceStatus(RS_NEUTRAL)

		Fly("PortOut_cam01", CINEMATIC_NO_AIM, 0, 5, 1, 0 )
		Fly("PlaneOut_cam02", CINEMATIC_NO_AIM, 0, 5, 0, 1 )
		StartCinematic()

		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trPortOut_cam01" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>

		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
			vehPlayer:SetGamePositionOnGround( CVector(806.148, 237.691, 1701.490))
			vehPlayer:SetRotation(Quaternion(0.083, 0.734, -0.016, 0.674))
			vehPlayer:SetExternalPathByName("player_path04")
		end

		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trPortOut_cam02" active="0">
		<event flypath="PlaneOut_cam02" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>

		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
			vehPlayer:SetGamePositionOnGround( CVector(1387.950, 211.036, 1593.858))
			vehPlayer:SetExternalPathByName("player_path02")
		end

		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_PortOut" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>

		RestoreAllToleranceStatus()

		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
			vehPlayer:SetExternalPathByName("player_path02")
			vehPlayer:PlaceToEndOfPath("player_path02")
		end


		TDeactivate("RolikBegin_PortOut")
		TDeactivate("trPortOut_cam01")
		TDeactivate("trPortOut_cam02")
		TActivate("trMorassTeleportBefore")
		TActivate("trMorassTeleportAfter")
		SetCameraBehindPlayerVehicle()
		trigger:Deactivate()
		</script>
	</trigger>


<!--		ролик с босом "война бобра с ослом"	:-)		-->


	<trigger Name="RolikBegin_Boss02" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
		GetPlayerVehicle():SetCustomLinearVelocity( 0 )

		PlayCustomMusic("Techno01")

		EnableGodMode()

		TActivate("RolikEnd_Boss02")
		TActivate("trBoss02_cam01")
		TActivate("trBoss02_cam02")
		TActivate("trBoss02_cam03")

		local BossID = GetEntityByName("bigboss1"):GetId()
		local vehPID = GetPlayerVehicleId()

		Fly("Boss02_cam01", CINEMATIC_NO_AIM, 0, 7, 1, 0 )
		Fly("Boss02_cam02", CINEMATIC_NO_AIM, 0, 10, 0, 0 )
		FlyLinked("Boss02_cam03", vehPID, 15, 0, 1, BossID, nil, nil, nil, nil )
		StartCinematic()

		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trBoss02_cam01" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>

		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
			vehPlayer:SetGamePositionOnGround( CVector(741.410, 271.384, 1461.900))
			vehPlayer:SetRotation(Quaternion(0.022, 0.881, -0.034, 0.472))
			vehPlayer:SetExternalPathByName("player_path06")
		end

		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trBoss02_cam02" active="0">
		<event flypath="Boss02_cam02" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>

		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
			vehPlayer:PlaceToEndOfPath("player_path06")
		end
--	диолог
--	незабудь закрыть ворота

		AddCinematicMessage( 15, 0.5)
		AddCinematicMessage( 16, 0.5)


		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trBoss02_cam03" active="0">
		<event flypath="Boss02_cam03" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
		AddCinematicMessage( 17, 0.5)
--	диолог

		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_Boss02" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>

		DisableGodMode()

		local vehPlayer = GetPlayerVehicle()
		if vehPlayer then
			vehPlayer:SetExternalPathByName("player_path06")
			vehPlayer:PlaceToEndOfPath("player_path06")
		end

		TActivate("trGateClose")

		TDeactivate("RolikBegin_Boss02")
		TDeactivate("trBoss02_cam01")
		TDeactivate("trBoss02_cam02")
		TDeactivate("trBoss02_cam03")

		PlayCustomMusic("Battle01")
		SetCameraBehindPlayerVehicle()
		local boss = getObj("bigboss1")
		if boss then
			ShowBossIndicator( boss:GetId() )
		end

		trigger:Deactivate()
		</script>
	</trigger>

<!--			Ролик подьезда к конвою лидера экстримистов		-->

	<trigger Name="RolikBegin_NearCaravanLeader" active="0">
		<event timeout="0.01" eventid="GE_TIME_PERIOD" />
		<script>
			ShowHostileVehicles(false)

			SaveAllToleranceStatus(RS_NEUTRAL)

			TActivate("RolikEnd_NearCaravanLeader")
			TActivate("trCaravan_cam01")
			TActivate("trCaravan_cam02")
			TActivate("trCaravan_cam03")
			TActivate("trCaravan_Fade")

			PlayCustomMusic("Passage01unloop")

			RuleConsole("cinematic_spring_coeff 6.0")

			local leader_car = CreateVehicleEx("Molokovoz01", "NPT_vehicle_4", CVector(0, 1000, 0), 1010, Quaternion(-0.016, 0.946, -0.025, 0.324))

			CreateVehicleEx("Bug01", "NPT_vehicle_3", CVector(0, 2000, 0), 1010, Quaternion(-0.011, 0.990, -0.027, 0.135))

			local Band = GetEntityByName("NPT_vehicle_3")
			local BandID = Band:GetId()
			local vehPID = GetPlayerVehicleId()
			local Lider = GetEntityByName("NPT_vehicle_4")
			local LiderID = Lider:GetId()

			FlyLinked( "Caravan_cam00", BandID , 7, 1, 0, vehPID, nil, true, nil, nil )
			FlyLinked( "Caravan_cam01", vehPID , 6, 0, 0, LiderID, nil, true, nil, nil )
			FlyLinked("Caravan_cam02", LiderID, 17, 0, 0, LiderID, nil, true, nil, nil )
			FlyLinked("Caravan_cam03", vehPID, 18, 0, 1, LiderID, nil, true, nil, nil )
			StartCinematic()

			AddCinematicMessage( 4, 1 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trCaravan_Fade" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			local npt_car1 = CreateVehicleEx("Revolutioner2", "NPT_vehicle_1", CVector(2335.757, 250.426, 2975.369), 1010, Quaternion(0.000, 0.964, 0.000, 0.265))
			local npt_car2 = CreateVehicleEx("Bug01", "NPT_vehicle_2", CVector(2325.117, 250.077, 3000.081), 1010, Quaternion(0.025, 0.985, 0.018, 0.170))
			local npt_car3 = getObj("NPT_vehicle_3")
			if npt_car3 then
				npt_car3:SetGamePositionOnGround(CVector(2316.018, 251.340, 3028.088))
				npt_car3:SetRotation(Quaternion(-0.011, 0.990, -0.027, 0.135))
			end

			-- Вынесено в отдельный триггер, потому что кончалыги из Таргем Геймс не умеют делать игры
			TActivate("trPlaceLeaderCar")

			local lcar = getObj("NPT_vehicle_4")
			if lcar then lcar:AttachTrailer("MolokovozTrailer") end

			for car = 1,4 do
				local npt_car = getObj("NPT_vehicle_"..car)
				if npt_car then
					npt_car:SetCruisingSpeed(12)
					npt_car:SetExternalPathByName("LeaderCar_path01")
					npt_car:SetRandomSkin()
				end
			end

			-- покраска трейлера после общего проставления скинов
			if lcar then PaintTrailer(lcar) end

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetCustomControlEnabled( true )
				vehPlayer:SetCustomLinearVelocity( 0 )
				vehPlayer:SetThrottle( 0 )
				vehPlayer:SetCustomControlEnabled( false )
				vehPlayer:SetGamePositionOnGround(CVector(2508.524, 250.664, 2645.997))
				vehPlayer:SetRotation(Quaternion(0.005, -0.135, 0.009, 0.991))
				vehPlayer:LimitMaxSpeed(5)
				vehPlayer:SetCustomLinearVelocity( 20 )
				vehPlayer:SetExternalPathByName("player_path07")
			end

			TActivate("trCaravanLeaderReach")
			TActivate("trCaravan1stVehReach")
			TActivate("trCaravan2ndVehReach")
			
			trigger:Deactivate()
		</script>
	</trigger>

	<!-- Вынесено в отдельный триггер, потому что кончалыги из Таргем Геймс не умеют делать игры -->
	<trigger Name="trPlaceLeaderCar" active="0">
		<event	timeout="0.01"		eventid="GE_TIME_PERIOD" />
		<script>
			local lcar = getObj("NPT_vehicle_4")
			if lcar then
				lcar:SetGamePositionOnGround(CVector(2350.553, 250.322, 2952.802))
				lcar:SetRotation(Quaternion(-0.016, 0.946, -0.025, 0.324))
			end
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trCaravanLeaderReach" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="NPT_vehicle_4"/>
		<script>
			local npt_car1 = getObj("NPT_vehicle_4")
			if npt_car1 then npt_car1:SetExternalPathByName("LeaderCar_path02") end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trCaravan1stVehReach" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="NPT_vehicle_1"/>
		<script>
			local npt_car2 = getObj("NPT_vehicle_1")
			if npt_car2 then npt_car2:SetExternalPathByName("LeaderCar_path03") end
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trCaravan2ndVehReach" active="0">
		<event eventid="GE_TARGET_REACHED" ObjName="NPT_vehicle_2"/>
		<script>
			local npt_car3 = getObj("NPT_vehicle_2")
			if npt_car3 then npt_car3:SetExternalPathByName("LeaderCar_path04") end
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trCaravan_cam01" active="0">
		<event flypath="Caravan_cam01" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>

			AddCinematicMessage( 5, 1 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trCaravan_cam02" active="0">
		<event flypath="Caravan_cam02" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>

			PlayCustomMusic("IntenseDialogue01")

			AddCinematicMessage( 6, 1 )
			AddCinematicMessage( 7, 1 )	

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trCaravan_cam03" active="0">
		<event flypath="Caravan_cam03" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			AddCinematicMessage( 8, 1 )
			AddCinematicMessage( 9, 1 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_NearCaravanLeader" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>

			RuleConsole("cinematic_spring_coeff 0.7")

			RestoreAllToleranceStatus()

			ShowHostileVehicles(true)

			SetTolerance(1100, 1010, RS_ENEMY)

			StopPlayingCustomMusic()

			local skins = {1,2,3,4}
			for car = 1,4 do
				local npt_car = getObj("NPT_vehicle_"..car)
				if npt_car then
					skins[car] = npt_car:GetSkin()
					npt_car:Remove()
				end
			end

			TeamCreate("LeaderGuardTeam",1010,CVector(getPos("LeaderCaravanStart_loc")),{"Revolutioner2","Bug01","Bug01"})

			local guard1 = getObj("LeaderGuardTeam"):GetVehicle(0)
			if guard1 then
				guard1:SetGamePositionOnGround(CVector(2450.231, 250.268, 2751.583))
				guard1:SetRotation(Quaternion(-0.001, 0.998, -0.005, -0.067))
				guard1:SetSkin(skins[1])
			end

			local guard2 = getObj("LeaderGuardTeam"):GetVehicle(1)
			if guard2 then
				guard2:SetGamePositionOnGround(CVector(2496.796, 250.706, 2769.292))
				guard2:SetRotation(Quaternion(-0.020, 0.890, -0.011, 0.456))
				guard2:SetSkin(skins[2])
			end

			local guard3 = getObj("LeaderGuardTeam"):GetVehicle(2)
			if guard3 then
				guard3:SetGamePositionOnGround(CVector(2458.987, 251.953, 2800.566))
				guard3:SetRotation(Quaternion(0.003, 0.983, 0.001, 0.182))
				guard3:SetSkin(skins[3])
			end

			TeamCreate("LeaderCar",1010,CVector(2474.402, 250.483, 2751.904),{"Molokovoz01"}, nil, nil, Quaternion(0.033, 0.988, -0.001, 0.153))

			local lcar = getObj("LeaderCar_vehicle_0")
			if lcar then
				lcar:SetSkin(skins[4])
				lcar:AttachTrailer("MolokovozTrailer")
				local trailer = lcar:GetTrailer()
				lcar:setImmortalMode(1)
				trailer:setImmortalMode(1)
				local nametr = trailer:GetName()
				PaintTrailer(lcar)

				local tr = getObj("trLeaderCarDie")
				if tr then
					tr:AddEvent("GE_VEHICLE_WITHOUT_HEALTH", nametr)
				end
			end

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
			vehPlayer:SetCustomControlEnabled( true )
			vehPlayer:SetCustomLinearVelocity( 0 )
			vehPlayer:SetThrottle( 0 )
			vehPlayer:SetCustomControlEnabled( false )
			vehPlayer:SetGamePositionOnGround(CVector(2490.111, 251.402, 2712.311))
			vehPlayer:SetRotation(Quaternion(0.027, -0.156, 0.006, 0.987))
			vehPlayer:UnlimitMaxSpeed()
			vehPlayer:PlaceToEndOfPath("player_path07")
			vehPlayer:setGodMode(0)
			end

			SetCameraBehindPlayerVehicle()

			TDeactivate("trCaravan_cam01")
			TDeactivate("trCaravan_cam02")           
			TDeactivate("trCaravan_cam03")   
			TDeactivate("trCaravan_Fade")
			TDeactivate("trCaravanLeaderReach")
			TDeactivate("trCaravan1stVehReach")
			TDeactivate("trCaravan2ndVehReach")

			TActivate("trMainCarDie")
			TActivate("trLeaderGuardsDie")
			TActivate("trLeaderCarDie")
			TActivate("trPlGOdMode2sec")

			CompleteQuest("FreeExtremistLeader_Quest3")
			TakeQuest("FreeExtremistLeader_Quest3_1")

			trigger:Deactivate()
		</script>
	</trigger>

<!--		подводная лодка			-->

<trigger Name="cinMovePlToR3M1_begin" active="0">
	<event	timeout="0.01"		eventid="GE_TIME_PERIOD" />
		<script>

			GetPlayerVehicle():SetCustomLinearVelocity( 0 )
			
			EnableGodMode()
			
			local stat = GetVar("SubMarPh").AsInt
            if stat==0 then
				Fly("lodka1", CINEMATIC_NO_AIM, 0, 15, 1, 0 )
				Fly("lodka2", CINEMATIC_NO_AIM, 0, 21, 0, 0 )
				Fly("lodka3", CINEMATIC_NO_AIM, 0, 18, 0, 1 )
				StartCinematic()

				AddCinematicMessage( 18, 3 )

				TActivate("cinMovePlToR3M1_Fade")
				TActivate("cinMovePlToR3M1_cam02")
				TActivate("cinMovePlToR3M1_cam03")
				TActivate("cinMovePlToR3M1_End")
			else
				Fly("lodka2", CINEMATIC_NO_AIM, 0, 21, 1, 0 )
				Fly("lodka3", CINEMATIC_NO_AIM, 0, 18, 0, 1 )
				StartCinematic()

				TActivate("cinMovePlToR3M1_FadeAlt")
				TActivate("cinMovePlToR3M1_cam03")
				TActivate("cinMovePlToR3M1_End")
			end
		
			PlayCustomMusic("Bio02")
						
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="cinMovePlToR3M1_Fade" active="0">
	<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetCustomLinearVelocity( 0 )
				vehPlayer:SetThrottle( 0 )
				vehPlayer:SetGamePositionOnGround( CVector(715.286, 217.935, 762.374))
		   		vehPlayer:SetRotation(Quaternion(-0.000, -1.000, -0.000, 0.020))
		   	end
		   	
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="cinMovePlToR3M1_FadeAlt" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
			<script>
				local vehPlayer = GetPlayerVehicle()
				if vehPlayer then
					vehPlayer:SetCustomLinearVelocity( 0 )
					vehPlayer:SetThrottle( 0 )
					vehPlayer:SetGamePositionOnGround( CVector(715.286, 217.935, 762.374))
					   vehPlayer:SetRotation(Quaternion(-0.000, -1.000, -0.000, 0.020))
				   end

				CreateNewDummyObject( "submarina",	"Subm", -1, -1, CVector(712.726, 160.000, 67.000), Quaternion(0.000, -0.008, -0.000, -1.000),0 )
			
				local moverId = CreateNewObject { prototypeName	= "cinematicMover", objName  = "" }
				local mover = GetEntityByID( moverId ) 
				local controlledObj = GetEntityByName("Subm")
				if controlledObj then
					mover:SetObjAndPath( controlledObj:GetId(), "lodka4", 20 )
				end

				trigger:Deactivate()
			</script>
		</trigger>

	<trigger Name="cinMovePlToR3M1_cam02" active="0">
	<event flypath="lodka2" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			CreateNewDummyObject( "submarina",	"Subm", -1, -1, CVector(712.726, 160.000, 67.000), Quaternion(0.000, -0.008, -0.000, -1.000),0 )
			
			local moverId = CreateNewObject { prototypeName	= "cinematicMover", objName  = "" }
			local mover = GetEntityByID( moverId ) 
			local controlledObj = GetEntityByName("Subm")
			local stat = GetVar("SubMarPh").AsInt
			if controlledObj then
				mover:SetObjAndPath( controlledObj:GetId(), "lodka4", 20 )
			end
			
            if stat==0 then
				AddCinematicMessage( 19, 8 )
			end
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="cinMovePlToR3M1_cam03" active="0">
	<event flypath="lodka3" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			local stat = GetVar("SubMarPh").AsInt
			local podlodka = getObj("Subm")
			if podlodka then
				podlodka:SetNodeAction(AT_STAND2)
			end
			
			if stat==0 then
				AddCinematicMessage( 20, 2 )
			end
			
			TActivate("trsubzaezd1")
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trsubzaezd1" active="0">
	<event	timeout="7"		eventid="GE_TIME_PERIOD" />
		<script>
			
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetExternalPathByName("subzaezd1")
				vehPlayer:LimitMaxSpeed( 20 )
		   	end
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="cinMovePlToR3M1_End" active="0">
	<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
	<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			
			SetVar("SubMarPh",1)

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetExternalPathByName("subzaezd1")
				vehPlayer:PlaceToEndOfPath()
				vehPlayer:UnlimitMaxSpeed()
		   	end
			
			StopPlayingCustomMusic()
			
			DisableGodMode()
			
			TActivate("trStartMap")
			
			TDeactivate("trsubzaezd1")
			TDeactivate("cinMovePlToR3M1_cam02")
			TDeactivate("cinMovePlToR3M1_cam03")
			TDeactivate("RrybakRoadStart")

			PassToMap("r3m1", "FromR1M4", 0 , 1)
			
			trigger:Deactivate()
		</script>
	</trigger>

</triggers>